<h1><%= @album.title %></h1>
<p><%= @album.description %></p>
<hr>

<% @album.images.each do |image| %>
  <h3><%= image.title %></h3>
  
  <a href="<%= image_url(image) %>">
    <img src="<%= image.file.url(:medium) %>" alt="<%= image.description %>">
  </a>
  
  <p><%= image.description %></p>
<% end %>

<hr>

<%= render "comments/form", :comment => Comment.new, :album_id => @album.id %>
<br>

<!-- nesting and juuuunk -->
<h2>comments:</h2>  
<ul>
  <% @album.comments.includes(:author).each do |comment| %>
    <li>
      <% author = comment.author %>
      posted by 
        <a href="<%= user_url(author) %>">
          <%= author.username %>
        </a> at <%= comment.created_at %>

      <% if current_user && 
           (current_user.id == author.id || current_user.id == @album.user_id) %>
        <%= button_to "delete", comment_url(comment), :method => :delete %>
      <% end %>
      <br>

      <%= comment.body %>
    </li>
    <br>
  <% end %>
</ul>

<% if current_user && @album.user_id == current_user.id %>
  <a href="<%= edit_album_url(@album) %>">edit this album</a>
<% end %>